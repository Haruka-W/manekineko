<h1 class="subtitle is-1 has-text-primary">投稿詳細ページ</h1>

<div class="tile is-ancestor">
	<div class="tile is-parent">
		<!-- 画像表示 -->
		<div class="tile is-child box">
			<%= attachment_image_tag @post, :image, :fill, 700, 450, fallback: "no_image.jpg" %>
			<hr>
			<!-- ログイン時のみいいねボタン表示 -->
			<% if user_signed_in? %>
			<div id="post-<%= @post.id %>">
				<%= render partial: "posts/favorite", locals: { post: @post } %>
			</div>
			<% end %>
			<!-- 募集情報 -->
			<p>[ 投稿タイトル ]<br><%= @post.title %></p>
			<p>[ 内容 ]<br><%= @post.content %></p>
			<p>[ 猫情報 ]<br><%= @post.sex %> ／ <%= @post.age %> ／ <%= @post.type %></p>
			<p>[ 投稿日 ]<br><%= @post.created_at.strftime('%Y/%m/%d') %></p>
			<!-- ログインしている会員の場合のみ編集と削除ボタンを表示 -->
			<% if @post.user == current_user %>
			<hr>
			<%= link_to "内容を変更する", edit_post_path(@post), class: "button is-success" %>
			<%= link_to "この投稿を削除する", post_path(@post), class: "button is-danger", method: :delete, data:{confirm: "本当に消しますか？"} %>
			<% end %>
		</div>
	</div>
	<div class="tile is-parent">
		<div class="tile is-child">
			<!-- 投稿者情報ここから -->
			<h4 class="subtitle is-3">投稿者情報</h4>
			<p>[ ハンドルネーム ]<br><%= link_to @post.user.handle_name, user_path(@post.user.id) %></p>
			<p>[ 自己紹介文 ]<br><%= @post.user.profile %></p>
			<p>[ 住所 ]<br><%= @post.user.prefecture %></p>
			<!-- 投稿者情報ここまで -->
			<hr>
			<!-- コメント欄ここから -->
			<h4 class="subtitle is-3">コメント欄</h4>
			<!-- コメントの表示 -->
			<% @post.post_comments.each do |post_comment| %>
				<div class="comment">
				<div><%= post_comment.comment %></div>
				<span class="is-size-7"><%= link_to post_comment.user.handle_name, user_path(post_comment.user.id) %></span>
				<span class="is-size-7"><%= post_comment.created_at.strftime('%Y/%m/%d') %></span>
				<!-- コメントを投稿したユーザーのみ削除ボタンが表示される -->
				<% if post_comment.user == current_user %>
					<%= link_to "", post_post_comments_path(post_comment), class: "delete is-small", method: :delete, data:{confirm: "コメントを削除しますか？"} %>
				<% end %>
				</div>
			<% end %>
			<!-- ログイン時はコメント入力フォーム表示 -->
			<% if user_signed_in? %>
				<%= form_for [@post, @post_comment] do |f| %>
				<%= f.text_area :comment, class: "textarea",placeholder: "この投稿への感想などはこちらへどうぞ！" %>
				<%= f.submit "コメントを送信する", class: "button is-info is-pulled-right" %>
				<% end %>
			<% else %>
				<div class="box">
					<p>
						コメントの投稿は会員のみが利用できます。<br>
						新規会員登録は<%= link_to "こちら", "/users/sign_up" %>から。
					</p>
				</div>
			<% end %>
			<!-- コメント欄ここまで -->
		</div>
	</div>
</div>
